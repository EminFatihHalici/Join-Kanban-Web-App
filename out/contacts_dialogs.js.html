<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: contacts_dialogs.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: contacts_dialogs.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Contact Dialog Management Module
 * Handles all dialog-related operations for contact management
 * Includes dialog creation, editing, deletion, and mobile menu interactions
 */

/**
 * Shows the large contact view with slide-in animation and focus management
 * @param {Event} ev - The triggering event
 * @param {string} contactJson - JSON string of the contact data
 * @param {string} color - The contact's background color
 */
function contactsLargeSlideIn(ev, contactJson, color) {
    let contactLargeRef = document.getElementById('contactDisplayLarge');
    contactLargeRef.style.display = 'none';
    contactLargeRef.innerHTML = '';
    let contact = JSON.parse(contactJson);
    lastFocusedContact = ev.currentTarget;
    let contactCardsActive = document.querySelectorAll('.contact-list-card-active');
    for (let i = 0; i &lt; contactCardsActive.length; i++) {
        contactCardsActive[i].classList.remove('contact-list-card-active');
        contactCardsActive[i].classList.add('contact-list-card')
    };
    ev.currentTarget.classList.remove('contact-list-card');
    ev.currentTarget.classList.add('contact-list-card-active');
    contactLargeRef.innerHTML = renderContactLargeHtml(contact, color);
    contactLargeSetFocusAndKeyEscapeHandling(contactLargeRef);
}

/**
 * Sets focus and keyboard escape handling for the large contact display
 * Manages timing, visibility, ARIA attributes, and focus management for contact overlay
 * @param {HTMLElement} contactLargeRef - The contact display large element
 */
function contactLargeSetFocusAndKeyEscapeHandling(contactLargeRef) {
    setTimeout(() => {
        contactLargeRef.style.display = 'block';
        contactLargeRef.setAttribute('aria-hidden', 'false');
        const editButton = contactLargeRef.querySelector('#edit-contact-btn');
        if (editButton) {
            editButton.focus();
        }
        const handleEscapeKey = (event) => {
            if (event.key === 'Escape') {
                event.preventDefault();
                closeContactOverlay();
                document.removeEventListener('keydown', handleEscapeKey);
            }
        };
        document.addEventListener('keydown', handleEscapeKey);
    }, 10);
}

/**
 * Shows the dialog for creating a new contact
 * @param {string} id - The ID of the modal dialog
 * @param {Event} ev - The triggering event
 */
async function showDialogCreateContact(id, ev) {
    ev.stopPropagation();
    const modal = document.getElementById(id);
    bool = [0, 0];
    modal.innerHTML = renderAddNewContactOverlayHtml();
    modal.showModal();
    setTimeout(() => {
        modal.classList.add("open");
    }, 10);

    checkAllCreateContactValidations('contactCreateBtn');
    await loadAndRenderContacts('contactList', 'contacts');;
}

/**
 * Shows the dialog for editing or deleting a contact
 * @param {string} id - The ID of the modal dialog
 * @param {string} contactJson - JSON string of the contact data
 * @param {string} color - The contact's background color
 * @param {Event} ev - The triggering event
 * @param {string} option - The action ('Edit' or 'Delete')
 */
async function showDialogContact(id, contactJson, color, ev, option) {
    ev.stopPropagation();
    let contactEditDeleteModal = document.getElementById(id);
    let contact = JSON.parse(contactJson);
    bool = [1, 1];
    contactEditDeleteModal.innerHTML = renderEditContactOverlayHtml(contact, color, option);
    contactEditDeleteModal.showModal();
    setTimeout(() => {
        contactEditDeleteModal.classList.add("open");
    }, 10);
    await renderContacts();
}

/**
 * Cancels and closes the contact dialog
 * @param {Event} ev - The triggering event
 */
function contactCancel(ev) {
    ev.preventDefault();
    ev.stopPropagation();

    const modal = ev.target.closest("dialog");
    if (!modal) return;

    modal.classList.remove("open");
    modal.close();
}

/**
 * Closes the contact overlay and returns focus to the last focused contact
 */
function closeContactOverlay() {
    const overlay = document.getElementById('contactDisplayLarge');
    
    overlay.classList.remove('open');
    overlay.style.display = 'none';
    overlay.setAttribute('aria-hidden', 'true');
    
    document.body.classList.remove('no-scroll');
    
    // Return focus to last focused contact in the list
    if (lastFocusedContact) {
        lastFocusedContact.focus();
        lastFocusedContact = null;
    }
}

/**
 * Opens the edit contact dialog from mobile menu
 * @param {string} contactJson - JSON string of the contact data
 * @param {string} color - The contact's background color
 */
function openEditContact(contactJson, color) {
    toggleMobileContactMenu();
    showDialogContact('contactEditDeleteModal', contactJson, color, event, 'Edit');
}

/**
 * Opens the delete contact dialog from mobile menu
 * @param {string} contactJson - JSON string of the contact data
 * @param {string} color - The contact's background color
 */
function openDeleteContact(contactJson, color) {
    toggleMobileContactMenu();
    showDialogContact('contactEditDeleteModal', contactJson, color, event, 'Delete');
}

/**
 * Updated toggleMobileContactMenu function to manage ARIA states
 */
function toggleMobileContactMenu() {
    const menu = document.getElementById('mobileContactMenu');
    const button = document.querySelector('.mobile-actions-btn');
    const isOpen = menu.classList.contains('show');
    if (isOpen) {
        menu.classList.remove('show');
        menu.setAttribute('aria-hidden', 'true');
        button.setAttribute('aria-expanded', 'false');
        document.body.onclick = null;
    } else {
        menu.classList.add('show');
        menu.setAttribute('aria-hidden', 'false');
        button.setAttribute('aria-expanded', 'true');
        const firstMenuItem = menu.querySelector('button[role="menuitem"]');
        if (firstMenuItem) { firstMenuItem.focus(); }
        toggleMobileContactMenuTimeoutAriaAndFocus(menu, button);
    }
}

/**
 * Sets up click-outside behavior for mobile contact menu with timeout and ARIA management
 * @param {HTMLElement} menu - The mobile contact menu element
 * @param {HTMLElement} button - The menu toggle button element
 */
function toggleMobileContactMenuTimeoutAriaAndFocus(menu, button) {
    setTimeout(() => {
        document.body.onclick = (ev) => {
            if (!menu.contains(ev.target) &amp;&amp;
                !button.contains(ev.target)) {
                menu.classList.remove('show');
                menu.setAttribute('aria-hidden', 'true');
                button.setAttribute('aria-expanded', 'false');
                button.focus(); // Return focus to button
                document.body.onclick = null;
            }
        };
    }, 0);
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addSubtaskEdit">addSubtaskEdit</a></li><li><a href="global.html#addUser">addUser</a></li><li><a href="global.html#animateLogoFirstVisit">animateLogoFirstVisit</a></li><li><a href="global.html#bindDialogAccessibilityKeys">bindDialogAccessibilityKeys</a></li><li><a href="global.html#calcNextId">calcNextId</a></li><li><a href="global.html#cancelMainSubtaskInput">cancelMainSubtaskInput</a></li><li><a href="global.html#categoryColor">categoryColor</a></li><li><a href="global.html#changePasswordIcon">changePasswordIcon</a></li><li><a href="global.html#checkAllCreateContactValidations">checkAllCreateContactValidations</a></li><li><a href="global.html#checkAllValidations">checkAllValidations</a></li><li><a href="global.html#checkContactForPhone">checkContactForPhone</a></li><li><a href="global.html#checkContactForPhoneHtml">checkContactForPhoneHtml</a></li><li><a href="global.html#checkForAndDisplaySubtasks">checkForAndDisplaySubtasks</a></li><li><a href="global.html#checkForAndDisplayUserCircles">checkForAndDisplayUserCircles</a></li><li><a href="global.html#checkIconPathAndSetNewIconAndInputType">checkIconPathAndSetNewIconAndInputType</a></li><li><a href="global.html#checkLoggedInPageSecurity">checkLoggedInPageSecurity</a></li><li><a href="global.html#checkTaskAssignedAgainstNullOrInvalidContacts">checkTaskAssignedAgainstNullOrInvalidContacts</a></li><li><a href="global.html#clearAllContactsInputFields">clearAllContactsInputFields</a></li><li><a href="global.html#clearAllSignUpInputFields">clearAllSignUpInputFields</a></li><li><a href="global.html#clearError">clearError</a></li><li><a href="global.html#clearForm">clearForm</a></li><li><a href="global.html#clickOutsideEventListener">clickOutsideEventListener</a></li><li><a href="global.html#closeAddTaskOverlay">closeAddTaskOverlay</a></li><li><a href="global.html#closeContactOverlay">closeContactOverlay</a></li><li><a href="global.html#closeDropDownAndResetFocus">closeDropDownAndResetFocus</a></li><li><a href="global.html#contactCancel">contactCancel</a></li><li><a href="global.html#contactLargeSetFocusAndKeyEscapeHandling">contactLargeSetFocusAndKeyEscapeHandling</a></li><li><a href="global.html#contactsLargeSlideIn">contactsLargeSlideIn</a></li><li><a href="global.html#convertContactsFetchObjectToArray">convertContactsFetchObjectToArray</a></li><li><a href="global.html#countTasks">countTasks</a></li><li><a href="global.html#createContact">createContact</a></li><li><a href="global.html#createInitialCircle">createInitialCircle</a></li><li><a href="global.html#createNextIdPutDataAndRender">createNextIdPutDataAndRender</a></li><li><a href="global.html#createTaskObject">createTaskObject</a></li><li><a href="global.html#deletePath">deletePath</a></li><li><a href="global.html#deleteSubtaskEdit">deleteSubtaskEdit</a></li><li><a href="global.html#deleteTaskfromBoard">deleteTaskfromBoard</a></li><li><a href="global.html#dragendHandler">dragendHandler</a></li><li><a href="global.html#dragoverHandler">dragoverHandler</a></li><li><a href="global.html#dragstartHandler">dragstartHandler</a></li><li><a href="global.html#eachPageSetCurrentUserInitials">eachPageSetCurrentUserInitials</a></li><li><a href="global.html#editSubtask">editSubtask</a></li><li><a href="global.html#extractTasks">extractTasks</a></li><li><a href="global.html#fetchAndAddIdAndRemoveUndefinedContacts">fetchAndAddIdAndRemoveUndefinedContacts</a></li><li><a href="global.html#fetchAndSortContacts">fetchAndSortContacts</a></li><li><a href="global.html#fetchData">fetchData</a></li><li><a href="global.html#finalizeTaskCreation">finalizeTaskCreation</a></li><li><a href="global.html#findNextDeadline">findNextDeadline</a></li><li><a href="global.html#formatDate">formatDate</a></li><li><a href="global.html#getGreetingText">getGreetingText</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#getMergedTaskData">getMergedTaskData</a></li><li><a href="global.html#groupContactsByLetter">groupContactsByLetter</a></li><li><a href="global.html#guestLogin">guestLogin</a></li><li><a href="global.html#handleAssignedDropdownEditKeydown">handleAssignedDropdownEditKeydown</a></li><li><a href="global.html#handleAssignedDropdownKeydown">handleAssignedDropdownKeydown</a></li><li><a href="global.html#handleAutoScroll">handleAutoScroll</a></li><li><a href="global.html#handleCategoryDropdownKeydown">handleCategoryDropdownKeydown</a></li><li><a href="global.html#handleCloseKeydown">handleCloseKeydown</a></li><li><a href="global.html#handleContactBackKeydown">handleContactBackKeydown</a></li><li><a href="global.html#handleContactCancelKeydown">handleContactCancelKeydown</a></li><li><a href="global.html#handleContactCloseKeydown">handleContactCloseKeydown</a></li><li><a href="global.html#handleContactDeleteKeydown">handleContactDeleteKeydown</a></li><li><a href="global.html#handleContactEditKeydown">handleContactEditKeydown</a></li><li><a href="global.html#handleContactKeydown">handleContactKeydown</a></li><li><a href="global.html#handleContactSubmitKeydown">handleContactSubmitKeydown</a></li><li><a href="global.html#handleCreateTask">handleCreateTask</a></li><li><a href="global.html#handleDeleteTaskKeydown">handleDeleteTaskKeydown</a></li><li><a href="global.html#handleDropdown">handleDropdown</a></li><li><a href="global.html#handleEditTaskKeydown">handleEditTaskKeydown</a></li><li><a href="global.html#handleGlobalResize">handleGlobalResize</a></li><li><a href="global.html#handleMenuEscapeKey">handleMenuEscapeKey</a></li><li><a href="global.html#handleMobileDeleteKeydown">handleMobileDeleteKeydown</a></li><li><a href="global.html#handleMobileEditKeydown">handleMobileEditKeydown</a></li><li><a href="global.html#handleMobileMenuKeydown">handleMobileMenuKeydown</a></li><li><a href="global.html#handlePasswordToggleKeydown">handlePasswordToggleKeydown</a></li><li><a href="global.html#handlePriorityKeydown">handlePriorityKeydown</a></li><li><a href="global.html#handleResizeOverlay">handleResizeOverlay</a></li><li><a href="global.html#handleSaveKeydown">handleSaveKeydown</a></li><li><a href="global.html#handleScrollDown">handleScrollDown</a></li><li><a href="global.html#handleScrollLeft">handleScrollLeft</a></li><li><a href="global.html#handleScrollRight">handleScrollRight</a></li><li><a href="global.html#handleScrollUp">handleScrollUp</a></li><li><a href="global.html#handleScrollXStop">handleScrollXStop</a></li><li><a href="global.html#handleScrollYStop">handleScrollYStop</a></li><li><a href="global.html#handleSearchButtonKeydown">handleSearchButtonKeydown</a></li><li><a href="global.html#handleSearchKeydown">handleSearchKeydown</a></li><li><a href="global.html#handleSubtaskAddKeydown">handleSubtaskAddKeydown</a></li><li><a href="global.html#handleSubtaskCancelKeydown">handleSubtaskCancelKeydown</a></li><li><a href="global.html#handleSubtaskDeleteKeydown">handleSubtaskDeleteKeydown</a></li><li><a href="global.html#handleSubtaskEditActionKeydown">handleSubtaskEditActionKeydown</a></li><li><a href="global.html#handleSubtaskEditKeydown">handleSubtaskEditKeydown</a></li><li><a href="global.html#handleSubtaskKey">handleSubtaskKey</a></li><li><a href="global.html#handleSubtaskRowKeydown">handleSubtaskRowKeydown</a></li><li><a href="global.html#handleSubtaskSaveKeydown">handleSubtaskSaveKeydown</a></li><li><a href="global.html#handleSubtaskToggleKeydown">handleSubtaskToggleKeydown</a></li><li><a href="global.html#handleSummaryLinkKeydown">handleSummaryLinkKeydown</a></li><li><a href="global.html#handleTaskCardKeydown">handleTaskCardKeydown</a></li><li><a href="global.html#handleUserMenuKeydown">handleUserMenuKeydown</a></li><li><a href="global.html#handlecontactSelectonCheckboxKeydown">handlecontactSelectonCheckboxKeydown</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initAddTask">initAddTask</a></li><li><a href="global.html#initNavKeyboardSupport">initNavKeyboardSupport</a></li><li><a href="global.html#initSummary">initSummary</a></li><li><a href="global.html#initializeEditTaskAccessibility">initializeEditTaskAccessibility</a></li><li><a href="global.html#isCheckboxValid">isCheckboxValid</a></li><li><a href="global.html#isConfirmValid">isConfirmValid</a></li><li><a href="global.html#isEmailValid">isEmailValid</a></li><li><a href="global.html#isNameValid">isNameValid</a></li><li><a href="global.html#isPassValid">isPassValid</a></li><li><a href="global.html#isPhoneValid">isPhoneValid</a></li><li><a href="global.html#isTaskEntry">isTaskEntry</a></li><li><a href="global.html#loadActiveUserId">loadActiveUserId</a></li><li><a href="global.html#loadAndRenderContacts">loadAndRenderContacts</a></li><li><a href="global.html#loadEditTaskDetailOverlay">loadEditTaskDetailOverlay</a></li><li><a href="global.html#loadFillInputFields">loadFillInputFields</a></li><li><a href="global.html#loadShownGreeting">loadShownGreeting</a></li><li><a href="global.html#loadTaskVariableGlobally">loadTaskVariableGlobally</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#moveTo">moveTo</a></li><li><a href="global.html#normalizeBoardValue">normalizeBoardValue</a></li><li><a href="global.html#openDeleteContact">openDeleteContact</a></li><li><a href="global.html#openDropDownResetFocusAndAddListener">openDropDownResetFocusAndAddListener</a></li><li><a href="global.html#openEditContact">openEditContact</a></li><li><a href="global.html#passwordVisible">passwordVisible</a></li><li><a href="global.html#positionSearchField">positionSearchField</a></li><li><a href="global.html#putData">putData</a></li><li><a href="global.html#refreshBoardAfterEdit">refreshBoardAfterEdit</a></li><li><a href="global.html#renderAddTAskOverlay">renderAddTAskOverlay</a></li><li><a href="global.html#renderAddTaskOverlay">renderAddTaskOverlay</a></li><li><a href="global.html#renderAllCircles">renderAllCircles</a></li><li><a href="global.html#renderAssignedEditCircles">renderAssignedEditCircles</a></li><li><a href="global.html#renderContactLarge">renderContactLarge</a></li><li><a href="global.html#renderContacts">renderContacts</a></li><li><a href="global.html#renderContactsInOverlay">renderContactsInOverlay</a></li><li><a href="global.html#renderEditTaskDetail">renderEditTaskDetail</a></li><li><a href="global.html#renderGreeting">renderGreeting</a></li><li><a href="global.html#renderGroupedContacts">renderGroupedContacts</a></li><li><a href="global.html#renderLimitedCircles">renderLimitedCircles</a></li><li><a href="global.html#renderPlusCircle">renderPlusCircle</a></li><li><a href="global.html#renderSingleCircle">renderSingleCircle</a></li><li><a href="global.html#renderSubtasksForOverlay">renderSubtasksForOverlay</a></li><li><a href="global.html#renderSummaryCounts">renderSummaryCounts</a></li><li><a href="global.html#renderTaskDetail">renderTaskDetail</a></li><li><a href="global.html#renderTasks">renderTasks</a></li><li><a href="global.html#resetCategoryInput">resetCategoryInput</a></li><li><a href="global.html#resetCustomUIComponents">resetCustomUIComponents</a></li><li><a href="global.html#resetGlobalVariables">resetGlobalVariables</a></li><li><a href="global.html#resetMainSubtaskIcons">resetMainSubtaskIcons</a></li><li><a href="global.html#resetValidationVisuals">resetValidationVisuals</a></li><li><a href="global.html#saveEditedSubtask">saveEditedSubtask</a></li><li><a href="global.html#saveEditedTask">saveEditedTask</a></li><li><a href="global.html#saveTaskToServer">saveTaskToServer</a></li><li><a href="global.html#saveToLocalStorage">saveToLocalStorage</a></li><li><a href="global.html#searchAndClearSearchField">searchAndClearSearchField</a></li><li><a href="global.html#searchFieldPositionInclusiveWcagAriaConformityA">searchFieldPositionInclusiveWcagAriaConformityA</a></li><li><a href="global.html#searchFieldPositionInclusiveWcagAriaConformityB">searchFieldPositionInclusiveWcagAriaConformityB</a></li><li><a href="global.html#searchTasks">searchTasks</a></li><li><a href="global.html#selectCategory">selectCategory</a></li><li><a href="global.html#setCheckboxesById">setCheckboxesById</a></li><li><a href="global.html#setContactDataForBackendUpload">setContactDataForBackendUpload</a></li><li><a href="global.html#setDataForBackendUpload">setDataForBackendUpload</a></li><li><a href="global.html#setEditPrio">setEditPrio</a></li><li><a href="global.html#setEditPrioSetActivePriorityButton">setEditPrioSetActivePriorityButton</a></li><li><a href="global.html#setupEditFormValidation">setupEditFormValidation</a></li><li><a href="global.html#setupFormElements">setupFormElements</a></li><li><a href="global.html#setupPriorityButtons">setupPriorityButtons</a></li><li><a href="global.html#showDialogContact">showDialogContact</a></li><li><a href="global.html#showDialogCreateContact">showDialogCreateContact</a></li><li><a href="global.html#showGreetingOverlay">showGreetingOverlay</a></li><li><a href="global.html#showPopup">showPopup</a></li><li><a href="global.html#showSuccessImageAnimation">showSuccessImageAnimation</a></li><li><a href="global.html#slideInOverlay">slideInOverlay</a></li><li><a href="global.html#startAutoScroll">startAutoScroll</a></li><li><a href="global.html#stopAutoScroll">stopAutoScroll</a></li><li><a href="global.html#toggleAssignedDropdown">toggleAssignedDropdown</a></li><li><a href="global.html#toggleCategoryDropdown">toggleCategoryDropdown</a></li><li><a href="global.html#toggleContactDropdown">toggleContactDropdown</a></li><li><a href="global.html#toggleContactDropdownEdit">toggleContactDropdownEdit</a></li><li><a href="global.html#toggleContactSelection">toggleContactSelection</a></li><li><a href="global.html#toggleDropDownMenu">toggleDropDownMenu</a></li><li><a href="global.html#toggleEditAssign">toggleEditAssign</a></li><li><a href="global.html#toggleIfDropdownExist">toggleIfDropdownExist</a></li><li><a href="global.html#toggleMobileContactMenu">toggleMobileContactMenu</a></li><li><a href="global.html#toggleMobileContactMenuTimeoutAriaAndFocus">toggleMobileContactMenuTimeoutAriaAndFocus</a></li><li><a href="global.html#toggleNotAsDropdownDoesNotExist">toggleNotAsDropdownDoesNotExist</a></li><li><a href="global.html#toggleStyle">toggleStyle</a></li><li><a href="global.html#toggleSubtask">toggleSubtask</a></li><li><a href="global.html#toggleSubtaskWithScrollPreservation">toggleSubtaskWithScrollPreservation</a></li><li><a href="global.html#updateContact">updateContact</a></li><li><a href="global.html#updateContactRowVisuals">updateContactRowVisuals</a></li><li><a href="global.html#updatePrioUI">updatePrioUI</a></li><li><a href="global.html#updateSubtaskElementInDOM">updateSubtaskElementInDOM</a></li><li><a href="global.html#validateCategory">validateCategory</a></li><li><a href="global.html#validateCheckboxSeperately">validateCheckboxSeperately</a></li><li><a href="global.html#validateEditTaskForm">validateEditTaskForm</a></li><li><a href="global.html#validateField">validateField</a></li><li><a href="global.html#validateFieldContact">validateFieldContact</a></li><li><a href="global.html#validateTaskForm">validateTaskForm</a></li><li><a href="global.html#validateTaskFormCheckIfDateInputAndDateErrorExist">validateTaskFormCheckIfDateInputAndDateErrorExist</a></li><li><a href="global.html#validateTaskFormCheckIfTitleInputAndTitleErrorExist">validateTaskFormCheckIfTitleInputAndTitleErrorExist</a></li><li><a href="global.html#validateTaskFormIfDateSmallerToday">validateTaskFormIfDateSmallerToday</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Wed Dec 03 2025 14:37:43 GMT+0100 (Mitteleurop√§ische Normalzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
