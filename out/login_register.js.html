<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: login_register.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: login_register.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>let firebase = [];

/** Validates full name format (first name space last name with Unicode support) */
const isNameValid = val => /^[A-Z\-a-zÄÖÜäöüß]+\s[A-Z\-a-zÄÖÜäöüß\p{M}]+$/.test(val);
/** Validates email address format with length constraints */
const isEmailValid = val => /^(?=[a-zA-Z0-9@._%+-]{6,254}$)(?=[a-zA-Z0-9._%+-]{1,64}@)[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(val);
/** Validates password strength (uppercase, lowercase, number, special char, min 12 chars) */
const isPassValid = val => /[A-Z]/.test(val) &amp;&amp; /[a-z]/.test(val) &amp;&amp; /[0-9]/.test(val) &amp;&amp; /[!§$%&amp;\/\?\-\+#@]/.test(val) &amp;&amp; val.length >= 12;
/** Validates password confirmation matches original password */
const isConfirmValid = val => val === document.getElementById('passwordRegister').value;
/** Validates checkbox is checked */
const isCheckboxValid = () => document.getElementById('checkbox').checked;

let bool = [0, 0, 0, 0, 0]

// #region registration validation

/**
 * Validates an input field using a provided validation function
 * @param {string} inputId - The ID of the input element
 * @param {string} errMsgId - The ID of the error message element
 * @param {Function} validateFn - The validation function to use
 * @param {number} boolIndex - The index in the bool array to update
 * @param {string} errMsg - The error message to display
 * @param {boolean} shouldCheckAll - Whether to check all validations after this one
 * @returns {number} The validation result (0 or 1)
 */
function validateField(inputId, errMsgId, validateFn, boolIndex, errMsg, shouldCheckAll = true) {
    let input = document.getElementById(inputId);
    let errMsgElem = document.getElementById(errMsgId);
    if (validateFn(input.value)) {
        errMsgElem.style.display = 'none';
        bool[boolIndex] = 1;
    } else {
        errMsgElem.style.display = 'block';
        errMsgElem.innerText = errMsg;
        bool[boolIndex] = 0;
    }
    if (shouldCheckAll) { checkAllValidations() };
    return bool[boolIndex];
}

/**
 * Validates the privacy policy checkbox separately
 * @returns {number} The validation result (0 or 1)
 */
function validateCheckboxSeperately() {
    let checkbox = document.getElementById('checkbox');
    let errMsgCheckbox = document.getElementById('errMsgCheckbox');
    if (!checkbox.checked) {
        errMsgCheckbox.style.display = 'block';
        errMsgCheckbox.innerText = 'Please accept the privacy policy to continue';
        bool[4] = 0;
    } else {
        errMsgCheckbox.style.display = 'none';
        bool[4] = 1;
    }
    return bool[4]
}

/**
 * Checks all validations and enables/disables the sign up button
 */
function checkAllValidations() {
    let fourOutOfFive = bool[0] === 1 &amp;&amp; bool[1] === 1 &amp;&amp; bool[2] === 1 &amp;&amp; bool[3] === 1;
    if (fourOutOfFive) { validateCheckboxSeperately() };
    let signUpBtn = document.getElementById('signUp');
    let allBoolEqualOne = bool.every(el => el === 1);
    if (allBoolEqualOne) {
        signUpBtn.disabled = false;
        signUpBtn.ariaDisabled = false;
        signUpBtn.tabIndex = '1';
        signUpBtn.focus();
    } else {
        signUpBtn.disabled = true;
        signUpBtn.ariaDisabled = true;
    }
}

/**
 * Changes the password icon to visibility_off when user starts typing
 * @param {string} id - The ID of the icon element
 */
function changePasswordIcon(id) {
    let containerId = document.getElementById(`${id}`);
    if (containerId.src.endsWith('visibility.png')) {
        return;
    }
    containerId.src = '../assets/icons/visibility_off.png';
    containerId.alt = 'visibility_off icon';
}

/**
 * Toggles password visibility and preserves cursor position
 * @param {string} inputId - The ID of the password input element
 * @param {string} iconId - The ID of the toggle icon element
 * @param {Event} event - The triggering event
 */
function passwordVisible(inputId, iconId, event) {
    if (event) { event.preventDefault() }
    let input = document.getElementById(`${inputId}`);
    let icon = document.getElementById(`${iconId}`);
    let cursorPosition = input.selectionStart;
    checkIconPathAndSetNewIconAndInputType(icon, input);
    setTimeout(() => {
        input.focus();
        input.setSelectionRange(cursorPosition, cursorPosition)
    }, 0);
}

/**
 * Checks icon path and toggles between visibility icons and input types
 * @param {HTMLElement} icon - The icon element
 * @param {HTMLInputElement} input - The password input element
 */
function checkIconPathAndSetNewIconAndInputType(icon, input) {
    if (icon.src.endsWith('lock.png')) {
        return
    }
    else if (icon.src.endsWith('visibility_off.png')) {
        icon.src = '../assets/icons/visibility.png';
        icon.alt = 'visibility icon';
        input.type = 'text';
    } else {
        icon.src = '../assets/icons/visibility_off.png';
        icon.alt = 'visibility_off icon';
        input.type = 'password';
    }
}

// #endregion

// #region registration -> add New User to firebase DB

/**
 * Adds a new user to the Firebase database and handles success flow
 */
async function addUser() {
    let nextUserId = await calcNextId();
    await putData('/' + nextUserId, setDataForBackendUpload());
    clearAllSignUpInputFields();
    showPopup('popup');
    setTimeout(() => {
        window.location.href = '../index.html?msg=You signed up successfully';
    }, 1500);
}

/**
 * Collects and formats user registration data for backend upload
 * @returns {Object} User data object with name, email, password, contacts, and tasks
 */
function setDataForBackendUpload() {
    let nameRegister = document.getElementById('nameRegister');
    let emailRegister = document.getElementById('emailRegister');
    let passwordRegister = document.getElementById('passwordRegister');
    let data = {
        name: nameRegister.value.trim().split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '),
        email: emailRegister.value.trim().toLowerCase(),
        password: passwordRegister.value,
        contacts: {
            "0": {
                name: nameRegister.value.trim().split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' '),
                email: emailRegister.value.trim().toLowerCase(),
            }
        },
        tasks: ""
    };
    return data;
}

/**
 * Clears all sign up form input fields
 */
function clearAllSignUpInputFields() {
    let nameRegister = document.getElementById('nameRegister');
    let emailRegister = document.getElementById('emailRegister');
    let passwordRegister = document.getElementById('passwordRegister');
    let passwordRegisterConfirm = document.getElementById('passwordRegisterConfirm');
    let signUpBtn = document.getElementById('signUp');

    nameRegister.value = emailRegister.value = passwordRegister.value = passwordRegisterConfirm.value = '';
    signUpBtn.checked = false;
}

// #endregion

/**
 * Handles user login by validating credentials against Firebase database
 * @param {string} path - Optional path parameter (unused)
 */
async function login(path = "") {
    let email = document.getElementById('emailLogin');
    let password = document.getElementById('passwordLogin');
    let response = await fetchData();
    let activeUser = response.findIndex(user => user.email === email.value &amp;&amp; user.password === password.value);
    if (activeUser !== -1) {
        saveToLocalStorage(activeUser);
        window.location.href = `../html/summary.html`;
    } else {
        document.getElementById('errMsgPassword').style.display = "block";
        document.getElementById('errMsgPassword').innerText = "please double check email and password or not a Join user?";
    }
    email.value = password.value = '';
}

/**
 * Handles guest login by setting default user (ID: 0) and redirecting to summary
 */
function guestLogin() {
    let email = document.getElementById('emailLogin');
    let password = document.getElementById('passwordLogin');
    email.value = password.value = '';
    let activeUser = 0;
    saveToLocalStorage(activeUser)
    window.location.href = `../html/summary.html`;
}

/**
 * Animates the logo on first visit with responsive behavior for mobile and desktop
 */
function animateLogoFirstVisit() {
    let logoOverlay = document.getElementById('logoOverlay');
    let logo = document.getElementById('logo');
    let animatedImgMobile = document.getElementById('animatedImgMobile');
    if (window.innerWidth &lt;= 768) {
        logoOverlay.classList.add('animate-out-mobile');
        setTimeout(() => {
            animatedImgMobile.src = './assets/icons/Join_dark.png';
        }, 400);
    } else {
        logoOverlay.classList.add('animate-out');
    }
    setTimeout(() => {
        logoOverlay.style.display = 'none';
        logo.style.opacity = 1;
    }, 800);
}

/**
 * Saves user session data to localStorage
 * @param {number} activeUserId - The ID of the active user
 */
function saveToLocalStorage(activeUserId) {
    localStorage.setItem("activeUserId", JSON.stringify(activeUserId));
    localStorage.setItem("shownGreeting", "false");
}

/**
 * Keyboard event handler for password toggle buttons
 * @param {KeyboardEvent} event - The keyboard event
 * @param {string} inputId - The password input ID
 * @param {string} iconId - The icon element ID
 */
function handlePasswordToggleKeydown(event, inputId, iconId) {
    if (event.key === 'Enter' || event.key === ' ') {
        event.preventDefault();
        passwordVisible(inputId, iconId, event);
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addUser">addUser</a></li><li><a href="global.html#animateLogoFirstVisit">animateLogoFirstVisit</a></li><li><a href="global.html#calcNextId">calcNextId</a></li><li><a href="global.html#categoryColor">categoryColor</a></li><li><a href="global.html#changePasswordIcon">changePasswordIcon</a></li><li><a href="global.html#checkAllCreateContactValidations">checkAllCreateContactValidations</a></li><li><a href="global.html#checkAllValidations">checkAllValidations</a></li><li><a href="global.html#checkContactForPhone">checkContactForPhone</a></li><li><a href="global.html#checkContactForPhoneHtml">checkContactForPhoneHtml</a></li><li><a href="global.html#checkForAndDisplaySubtasks">checkForAndDisplaySubtasks</a></li><li><a href="global.html#checkForAndDisplayUserCircles">checkForAndDisplayUserCircles</a></li><li><a href="global.html#checkIconPathAndSetNewIconAndInputType">checkIconPathAndSetNewIconAndInputType</a></li><li><a href="global.html#checkIfElementIsNotDropdownOrDisplayElement">checkIfElementIsNotDropdownOrDisplayElement</a></li><li><a href="global.html#checkLoggedInPageSecurity">checkLoggedInPageSecurity</a></li><li><a href="global.html#checkTaskAssignedAgainstNullOrInvalidContacts">checkTaskAssignedAgainstNullOrInvalidContacts</a></li><li><a href="global.html#clearAllContactsInputFields">clearAllContactsInputFields</a></li><li><a href="global.html#clearAllSignUpInputFields">clearAllSignUpInputFields</a></li><li><a href="global.html#clickOutsideEventListener">clickOutsideEventListener</a></li><li><a href="global.html#closeAddTaskOverlay">closeAddTaskOverlay</a></li><li><a href="global.html#closeContactOverlay">closeContactOverlay</a></li><li><a href="global.html#closeDropDownAndResetFocus">closeDropDownAndResetFocus</a></li><li><a href="global.html#contactCancel">contactCancel</a></li><li><a href="global.html#contactsLargeSlideIn">contactsLargeSlideIn</a></li><li><a href="global.html#countTasks">countTasks</a></li><li><a href="global.html#createContact">createContact</a></li><li><a href="global.html#createInitialCircle">createInitialCircle</a></li><li><a href="global.html#createNextIdPutDataAndRender">createNextIdPutDataAndRender</a></li><li><a href="global.html#deletePath">deletePath</a></li><li><a href="global.html#deleteTaskfromBoard">deleteTaskfromBoard</a></li><li><a href="global.html#dragendHandler">dragendHandler</a></li><li><a href="global.html#dragoverHandler">dragoverHandler</a></li><li><a href="global.html#dragstartHandler">dragstartHandler</a></li><li><a href="global.html#eachPageSetCurrentUserInitials">eachPageSetCurrentUserInitials</a></li><li><a href="global.html#extractTasks">extractTasks</a></li><li><a href="global.html#fetchAndAddIdAndRemoveUndefinedContacts">fetchAndAddIdAndRemoveUndefinedContacts</a></li><li><a href="global.html#fetchAndSortContacts">fetchAndSortContacts</a></li><li><a href="global.html#fetchData">fetchData</a></li><li><a href="global.html#findNextDeadline">findNextDeadline</a></li><li><a href="global.html#formatDate">formatDate</a></li><li><a href="global.html#getGreetingText">getGreetingText</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#groupContactsByLetter">groupContactsByLetter</a></li><li><a href="global.html#guestLogin">guestLogin</a></li><li><a href="global.html#handleAutoScroll">handleAutoScroll</a></li><li><a href="global.html#handleCloseKeydown">handleCloseKeydown</a></li><li><a href="global.html#handleContactBackKeydown">handleContactBackKeydown</a></li><li><a href="global.html#handleContactCancelKeydown">handleContactCancelKeydown</a></li><li><a href="global.html#handleContactCloseKeydown">handleContactCloseKeydown</a></li><li><a href="global.html#handleContactDeleteKeydown">handleContactDeleteKeydown</a></li><li><a href="global.html#handleContactEditKeydown">handleContactEditKeydown</a></li><li><a href="global.html#handleContactKeydown">handleContactKeydown</a></li><li><a href="global.html#handleContactSubmitKeydown">handleContactSubmitKeydown</a></li><li><a href="global.html#handleDeleteTaskKeydown">handleDeleteTaskKeydown</a></li><li><a href="global.html#handleEditDropdown">handleEditDropdown</a></li><li><a href="global.html#handleEditTaskKeydown">handleEditTaskKeydown</a></li><li><a href="global.html#handleGlobalResize">handleGlobalResize</a></li><li><a href="global.html#handleMenuEscapeKey">handleMenuEscapeKey</a></li><li><a href="global.html#handleMobileDeleteKeydown">handleMobileDeleteKeydown</a></li><li><a href="global.html#handleMobileEditKeydown">handleMobileEditKeydown</a></li><li><a href="global.html#handleMobileMenuKeydown">handleMobileMenuKeydown</a></li><li><a href="global.html#handlePasswordToggleKeydown">handlePasswordToggleKeydown</a></li><li><a href="global.html#handleResizeOverlay">handleResizeOverlay</a></li><li><a href="global.html#handleSearchButtonKeydown">handleSearchButtonKeydown</a></li><li><a href="global.html#handleSearchKeydown">handleSearchKeydown</a></li><li><a href="global.html#handleSubtaskToggleKeydown">handleSubtaskToggleKeydown</a></li><li><a href="global.html#handleSummaryLinkKeydown">handleSummaryLinkKeydown</a></li><li><a href="global.html#handleTaskCardKeydown">handleTaskCardKeydown</a></li><li><a href="global.html#handleUserMenuKeydown">handleUserMenuKeydown</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initSummary">initSummary</a></li><li><a href="global.html#isCheckboxValid">isCheckboxValid</a></li><li><a href="global.html#isConfirmValid">isConfirmValid</a></li><li><a href="global.html#isEmailValid">isEmailValid</a></li><li><a href="global.html#isNameValid">isNameValid</a></li><li><a href="global.html#isPassValid">isPassValid</a></li><li><a href="global.html#isPhoneValid">isPhoneValid</a></li><li><a href="global.html#isTaskEntry">isTaskEntry</a></li><li><a href="global.html#loadActiveUserId">loadActiveUserId</a></li><li><a href="global.html#loadAndRenderContacts">loadAndRenderContacts</a></li><li><a href="global.html#loadShownGreeting">loadShownGreeting</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#moveTo">moveTo</a></li><li><a href="global.html#normalizeBoardValue">normalizeBoardValue</a></li><li><a href="global.html#openDeleteContact">openDeleteContact</a></li><li><a href="global.html#openDropDownResetFocusAndAddListener">openDropDownResetFocusAndAddListener</a></li><li><a href="global.html#openEditContact">openEditContact</a></li><li><a href="global.html#passwordVisible">passwordVisible</a></li><li><a href="global.html#positionSearchField">positionSearchField</a></li><li><a href="global.html#putData">putData</a></li><li><a href="global.html#renderAddTaskOverlay">renderAddTaskOverlay</a></li><li><a href="global.html#renderContactLarge">renderContactLarge</a></li><li><a href="global.html#renderContacts">renderContacts</a></li><li><a href="global.html#renderContactsInOverlay">renderContactsInOverlay</a></li><li><a href="global.html#renderEditTaskDetail">renderEditTaskDetail</a></li><li><a href="global.html#renderGreeting">renderGreeting</a></li><li><a href="global.html#renderGroupedContacts">renderGroupedContacts</a></li><li><a href="global.html#renderSubtasksForOverlay">renderSubtasksForOverlay</a></li><li><a href="global.html#renderSummaryCounts">renderSummaryCounts</a></li><li><a href="global.html#renderTaskDetail">renderTaskDetail</a></li><li><a href="global.html#renderTasks">renderTasks</a></li><li><a href="global.html#saveToLocalStorage">saveToLocalStorage</a></li><li><a href="global.html#searchAndClearSearchField">searchAndClearSearchField</a></li><li><a href="global.html#searchFieldPositionInclusiveWcagAriaConformityA">searchFieldPositionInclusiveWcagAriaConformityA</a></li><li><a href="global.html#searchFieldPositionInclusiveWcagAriaConformityB">searchFieldPositionInclusiveWcagAriaConformityB</a></li><li><a href="global.html#searchTasks">searchTasks</a></li><li><a href="global.html#setContactDataForBackendUpload">setContactDataForBackendUpload</a></li><li><a href="global.html#setDataForBackendUpload">setDataForBackendUpload</a></li><li><a href="global.html#showDialogContact">showDialogContact</a></li><li><a href="global.html#showDialogCreateContact">showDialogCreateContact</a></li><li><a href="global.html#showGreetingOverlay">showGreetingOverlay</a></li><li><a href="global.html#showPopup">showPopup</a></li><li><a href="global.html#slideInOverlay">slideInOverlay</a></li><li><a href="global.html#startAutoScroll">startAutoScroll</a></li><li><a href="global.html#stopAutoScroll">stopAutoScroll</a></li><li><a href="global.html#toggleDropDownMenu">toggleDropDownMenu</a></li><li><a href="global.html#toggleMobileContactMenu">toggleMobileContactMenu</a></li><li><a href="global.html#toggleStyle">toggleStyle</a></li><li><a href="global.html#toggleSubtask">toggleSubtask</a></li><li><a href="global.html#updateContact">updateContact</a></li><li><a href="global.html#validateCheckboxSeperately">validateCheckboxSeperately</a></li><li><a href="global.html#validateField">validateField</a></li><li><a href="global.html#validateFieldContact">validateFieldContact</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Mon Dec 01 2025 22:34:39 GMT+0100 (Mitteleuropäische Normalzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
